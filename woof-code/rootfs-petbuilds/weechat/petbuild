download() {
    [ -f weechat-3.5.tar.xz ] || wget -t 3 -T 60 https://weechat.org/files/src/weechat-3.5.tar.xz
}

build() {
    tar -xJf weechat-3.5.tar.xz
    cd weechat-3.5
    ./autogen.sh
    ./configure --prefix=/usr --sysconfdir=/etc --enable-ncurses --enable-headless
    make install
    weechat-headless -r "/server add libera irc.libera.chat/6697 -autoconnect -ssl;/set irc.server.libera.autojoin #puppylinux;/quit"
    [ -e /home ] || install -d -m 755 /home
    if [ -e /home/spot ]; then
        chown spot:spot /home/spot
    else
        install -d -m 700 -o spot -g spot /home/spot
    fi
    run-as-spot weechat-headless -r "/server add libera irc.libera.chat/6697 -autoconnect -ssl;/set irc.server.libera.autojoin #puppylinux;/quit"
    rm -rf /usr/bin/weechat-headless /usr/include /usr/lib/pkgconfig /usr/lib/weechat/plugins/*.a /usr/lib/weechat/plugins/*.la
    sed -e 's/^Categories=Network;Chat;/Categories=Chat;/' -i /usr/share/applications/weechat.desktop
}